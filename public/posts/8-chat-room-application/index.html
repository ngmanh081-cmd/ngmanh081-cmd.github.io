<!doctype html><html lang=en dir=auto data-theme=dark><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Project thực chiến: Code ứng dụng Chat Room nhiều người dùng | IndieGameDev.HuyManh</title><meta name=keywords content="Project,Java,Socket,Multi-thread"><meta name=description content="Tổng hợp toàn bộ kiến thức Socket và Thread để xây dựng một phòng chat nơi mọi người có thể nói chuyện với nhau (Broadcast)."><meta name=author content="Me"><link rel=canonical href=#ZgotmplZ><link crossorigin=anonymous href=/assets/css/stylesheet.fd5566c526ae48aadabd950798a2dc3568536401560eae5caac3765a42a9e7b5.css integrity="sha256-/VVmxSauSKravZUHmKLcNWhTZAFWDq5cqsN2WkKp57U=" rel="preload stylesheet" as=style><link rel=icon href=#ZgotmplZ><link rel=icon type=image/png sizes=16x16 href=#ZgotmplZ><link rel=icon type=image/png sizes=32x32 href=#ZgotmplZ><link rel=apple-touch-icon href=#ZgotmplZ><link rel=mask-icon href=#ZgotmplZ><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=#ZgotmplZ><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>localStorage.getItem("pref-theme")==="light"&&(document.querySelector("html").dataset.theme="light")</script><meta property="og:url" content="hhtp://localhost:1313/posts/8-chat-room-application/"><meta property="og:site_name" content="IndieGameDev.HuyManh"><meta property="og:title" content="Project thực chiến: Code ứng dụng Chat Room nhiều người dùng"><meta property="og:description" content="Tổng hợp toàn bộ kiến thức Socket và Thread để xây dựng một phòng chat nơi mọi người có thể nói chuyện với nhau (Broadcast)."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-12-18T00:00:00+00:00"><meta property="article:modified_time" content="2025-12-18T00:00:00+00:00"><meta property="article:tag" content="Project"><meta property="article:tag" content="Java"><meta property="article:tag" content="Socket"><meta property="article:tag" content="Multi-Thread"><meta name=twitter:card content="summary"><meta name=twitter:title content="Project thực chiến: Code ứng dụng Chat Room nhiều người dùng"><meta name=twitter:description content="Tổng hợp toàn bộ kiến thức Socket và Thread để xây dựng một phòng chat nơi mọi người có thể nói chuyện với nhau (Broadcast)."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"hhtp://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Project thực chiến: Code ứng dụng Chat Room nhiều người dùng","item":"hhtp://localhost:1313/posts/8-chat-room-application/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Project thực chiến: Code ứng dụng Chat Room nhiều người dùng","name":"Project thực chiến: Code ứng dụng Chat Room nhiều người dùng","description":"Tổng hợp toàn bộ kiến thức Socket và Thread để xây dựng một phòng chat nơi mọi người có thể nói chuyện với nhau (Broadcast).","keywords":["Project","Java","Socket","Multi-thread"],"articleBody":"Chúng ta đã học về Socket (kết nối) và Thread (đa luồng). Bây giờ là lúc ghép chúng lại để làm một sản phẩm thực tế: Chat Room Console Application.\nMô hình hoạt động của Chat Room khác với Echo Server ở chỗ: Khi User A nhắn tin, Server không chỉ trả lại cho A, mà phải gửi tin nhắn đó cho cả B, C và D. Kỹ thuật này gọi là Broadcasting.\n1. Kiến trúc hệ thống Server sẽ cần duy trì một “Danh sách các user đang online”.\nKhi có tin nhắn mới, Server duyệt qua danh sách này và gửi tin đi cho từng người. Khi có người ngắt kết nối, Server xóa họ khỏi danh sách. 2. Code Server hoàn chỉnh import java.io.*; import java.net.*; import java.util.*; public class ChatServer { private static final int PORT = 9090; // Set chứa các luồng writer của tất cả client đang kết nối // Dùng HashSet để tránh trùng lặp private static Set\u003cPrintWriter\u003e clientWriters = new HashSet\u003c\u003e(); public static void main(String[] args) throws Exception { System.out.println(\"Chat Server đang chạy...\"); ServerSocket listener = new ServerSocket(PORT); try { while (true) { // Chấp nhận kết nối và giao cho Handler xử lý new Handler(listener.accept()).start(); } } finally { listener.close(); } } // Class Handler chịu trách nhiệm xử lý từng client riêng biệt private static class Handler extends Thread { private Socket socket; private PrintWriter out; private BufferedReader in; public Handler(Socket socket) { this.socket = socket; } public void run() { try { in = new BufferedReader(new InputStreamReader(socket.getInputStream())); out = new PrintWriter(socket.getOutputStream(), true); // 1. Thêm writer của user này vào danh sách chung (đồng bộ hóa) synchronized (clientWriters) { clientWriters.add(out); } // 2. Lắng nghe tin nhắn và Broadcast String message; while ((message = in.readLine()) != null) { System.out.println(\"Nhận tin: \" + message); // Duyệt qua tất cả user khác và gửi tin nhắn này đi synchronized (clientWriters) { for (PrintWriter writer : clientWriters) { writer.println(message); } } } } catch (IOException e) { System.out.println(e); } finally { // 3. Nếu user thoát, xóa khỏi danh sách if (out != null) { synchronized (clientWriters) { clientWriters.remove(out); } } try { socket.close(); } catch (IOException e) {} } } } } ","wordCount":"371","inLanguage":"en","datePublished":"2025-12-18T00:00:00Z","dateModified":"2025-12-18T00:00:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"hhtp://localhost:1313/posts/8-chat-room-application/"},"publisher":{"@type":"Organization","name":"IndieGameDev.HuyManh","logo":{"@type":"ImageObject","url":"hhtp://localhost:1313/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=#ZgotmplZ accesskey=h title="IndieGameDev.HuyManh (Alt + H)">IndieGameDev.HuyManh</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=#ZgotmplZ title="Trang chủ"><span>Trang chủ</span></a></li><li><a href=#ZgotmplZ title="Bài viết"><span>Bài viết</span></a></li><li><a href=#ZgotmplZ title="Giới thiệu"><span>Giới thiệu</span></a></li><li><a href=#ZgotmplZ title="Liên hệ"><span>Liên hệ</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Project thực chiến: Code ứng dụng Chat Room nhiều người dùng</h1><div class=post-meta><span title='2025-12-18 00:00:00 +0000 UTC'>December 18, 2025</span>&nbsp;·&nbsp;<span>Me</span></div></header><div class=post-content><p>Chúng ta đã học về Socket (kết nối) và Thread (đa luồng). Bây giờ là lúc ghép chúng lại để làm một sản phẩm thực tế: <strong>Chat Room Console Application</strong>.</p><p>Mô hình hoạt động của Chat Room khác với Echo Server ở chỗ: Khi User A nhắn tin, Server không chỉ trả lại cho A, mà phải <strong>gửi tin nhắn đó cho cả B, C và D</strong>. Kỹ thuật này gọi là <strong>Broadcasting</strong>.</p><h2 id=1-kiến-trúc-hệ-thống>1. Kiến trúc hệ thống<a hidden class=anchor aria-hidden=true href=#1-kiến-trúc-hệ-thống>#</a></h2><p>Server sẽ cần duy trì một &ldquo;Danh sách các user đang online&rdquo;.</p><ul><li>Khi có tin nhắn mới, Server duyệt qua danh sách này và gửi tin đi cho từng người.</li><li>Khi có người ngắt kết nối, Server xóa họ khỏi danh sách.</li></ul><h2 id=2-code-server-hoàn-chỉnh>2. Code Server hoàn chỉnh<a hidden class=anchor aria-hidden=true href=#2-code-server-hoàn-chỉnh>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> java.io.*;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.net.*;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.*;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ChatServer</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> PORT <span style=color:#f92672>=</span> 9090;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Set chứa các luồng writer của tất cả client đang kết nối</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Dùng HashSet để tránh trùng lặp</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> Set<span style=color:#f92672>&lt;</span>PrintWriter<span style=color:#f92672>&gt;</span> clientWriters <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashSet<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;Chat Server đang chạy...&#34;</span>);
</span></span><span style=display:flex><span>        ServerSocket listener <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ServerSocket(PORT);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>while</span> (<span style=color:#66d9ef>true</span>) {
</span></span><span style=display:flex><span>                <span style=color:#75715e>// Chấp nhận kết nối và giao cho Handler xử lý</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> Handler(listener.<span style=color:#a6e22e>accept</span>()).<span style=color:#a6e22e>start</span>();
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>finally</span> {
</span></span><span style=display:flex><span>            listener.<span style=color:#a6e22e>close</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Class Handler chịu trách nhiệm xử lý từng client riêng biệt</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Handler</span> <span style=color:#66d9ef>extends</span> Thread {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> Socket socket;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> PrintWriter out;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> BufferedReader in;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Handler</span>(Socket socket) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>socket</span> <span style=color:#f92672>=</span> socket;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>run</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>                in <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> BufferedReader(<span style=color:#66d9ef>new</span> InputStreamReader(socket.<span style=color:#a6e22e>getInputStream</span>()));
</span></span><span style=display:flex><span>                out <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PrintWriter(socket.<span style=color:#a6e22e>getOutputStream</span>(), <span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 1. Thêm writer của user này vào danh sách chung (đồng bộ hóa)</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>synchronized</span> (clientWriters) {
</span></span><span style=display:flex><span>                    clientWriters.<span style=color:#a6e22e>add</span>(out);
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 2. Lắng nghe tin nhắn và Broadcast</span>
</span></span><span style=display:flex><span>                String message;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>while</span> ((message <span style=color:#f92672>=</span> in.<span style=color:#a6e22e>readLine</span>()) <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>                    System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;Nhận tin: &#34;</span> <span style=color:#f92672>+</span> message);
</span></span><span style=display:flex><span>                    
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// Duyệt qua tất cả user khác và gửi tin nhắn này đi</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>synchronized</span> (clientWriters) {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>for</span> (PrintWriter writer : clientWriters) {
</span></span><span style=display:flex><span>                            writer.<span style=color:#a6e22e>println</span>(message);
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>catch</span> (IOException e) {
</span></span><span style=display:flex><span>                System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(e);
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>finally</span> {
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 3. Nếu user thoát, xóa khỏi danh sách</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (out <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>synchronized</span> (clientWriters) {
</span></span><span style=display:flex><span>                        clientWriters.<span style=color:#a6e22e>remove</span>(out);
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>try</span> { socket.<span style=color:#a6e22e>close</span>(); } <span style=color:#66d9ef>catch</span> (IOException e) {}
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=#ZgotmplZ>Project</a></li><li><a href=#ZgotmplZ>Java</a></li><li><a href=#ZgotmplZ>Socket</a></li><li><a href=#ZgotmplZ>Multi-Thread</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=#ZgotmplZ>IndieGameDev.HuyManh</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>